
# Ценности

Главная цель Python Code Conventions — сохранение низкой стоимости разработки и поддержки кода на длинной дистанции.

Основные ценности, помогающие достичь этой цели:

**Читаемость**

Код должен легко читаться, а не легко записываться. Это значит, что такие вещи как синтаксический сахар (если он направлен на ускорение записи, а не дальнейшего чтения кода) вредны.
Обратите внимание, что быстродействие кода не является ценностью, поэтому не самый оптимальный цикл, но удобный для понимания, будет лучше, чем быстрый, но сложный. Не нужно экономить переменные, буквы для их названий, оперативную память и так далее.

**Вандалоустойчивость**

Код надо писать так, чтобы у разработчика, который с ним будет работать, было как можно меньше возможности внести ошибку. Например, покрывайте тестами не только краевые условия, но и кейсы, которые могут появиться в результате доработок кода и рефакторинга.

**Поддержание наименьшей энтропии**

Энтропия — это количество информации, из которой состоит проект (информационная емкость проекта). Код проекта должен выполнять продуктовые требования с сохранением наименьшей возможной энтропии.



# Принципы

Принципы — это способы соблюдения описанных выше ценностей. Они чуть более детальны, содержат основные методологии разработки и подходы, которыми мы руководствуемся.

Код должен быть:

- Понятным, явным. Явное лучше, чем неявное. PEP8, Zen of Python.
- Удобным для использования сейчас
- Удобным для использования в будущем
- Должен стремиться к соблюдению принципов [KISS](https://ru.wikipedia.org/wiki/KISS_(%D0%BF%D1%80%D0%B8%D0%BD%D1%86%D0%B8%D0%BF)), [SOLID](https://ru.wikipedia.org/wiki/SOLID_(%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D0%BD%D0%BE-%D0%BE%D1%80%D0%B8%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)), [DRY](https://ru.wikipedia.org/wiki/Don%E2%80%99t_repeat_yourself), [GRASP](https://ru.wikipedia.org/wiki/GRASP)
- Любая часть системы должна иметь изолированную логику и при надобности внешний интерфейс, который позволяет с этой логикой работать. Любая внутренняя часть должна иметь возможность быть измененной без какого-либо ущерба внешним системам
- Код должен быть таким, чтобы его можно было автоматически отрефакторить в IDE (например, Find usages и Rename в PyCharm). В частности, не следует давать слишком общие или короткие имена классам и методам, полям.
- Последовательным. Код должен читаться сверху вниз. Читающий не должен держать что-то в уме, возвращаться назад и интерпретировать код иначе.
- Должен иметь минимальную [цикломатическую сложность](https://ru.wikipedia.org/wiki/%D0%A6%D0%B8%D0%BA%D0%BB%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D1%81%D0%BB%D0%BE%D0%B6%D0%BD%D0%BE%D1%81%D1%82%D1%8C)



# Правила работы с `git`


### Решение каждой отдельной задачи оформлять в виде PR в метку master


# Правила написания кода


### Не перезаписывать переменные без явной алгоритмической необходимости

Мотивация: читаемость, упрощение отладки, предсказуемость.


Плохо:

```python
account = AccountSchema.extract()
account = Account.create(account['name'], account['password'])
```

Хорошо:

```python
data = AccountSchema.extract()
account = Account.create(data['name'], data['password'])
```

Хорошо:

```python
counter = 0
while counter < 10:
    counter = counter + 2
```



### Создание объекта по возможности должно быть сокрыто в конструкторе

Мотивация: принцип единственной ответственности, транзакционность конструктора, инкапсуляция конструирования.

Плохо:

```python
def clone(self):
    report = Report()
    report.name = self.name
    report.filters = self.filters
    report.slices = self.slices
    report.columns = self.columns
    return report
```

Хорошо:
```python
def clone(self):
    return Report(
        name=self.name,
        filters=self.filters,
        slices=self.slices,
        columns=self.columns
    )
```


### Закрывающуюся скобку для многострочных выражений ставить на новой строке на вертикальном уровне начала выражения

Мотивация: единообразие стиля в кодовой базе, читаемость (скобки в рациональном стиле K&R задают однообразную хорошо воспринимаемую визуально структуру), скобка не меняет положения в diff-ах коммитов.

Плохо:

```python
return Report(name=self.name,
              filters=self.filters,
              slices=self.slices,
              columns=self.columns)
```

Плохо:

```python
return Report(
    name=self.name,
    filters=self.filters,
    slices=self.slices,
    columns=self.columns)
```

Хорошо:
```python
return Report(
    name=self.name,
    filters=self.filters,
    slices=self.slices,
    columns=self.columns
)
```


### Использовать факт, что пустые коллекции вычисляются в `False` в булевом контексте

Мотивация: [PEP8](https://www.python.org/dev/peps/pep-0008/#programming-recommendations):

> For sequences, (strings, lists, tuples), use the fact that empty sequences are false.

Плохо:

```python
if len(metric.functions) == 0:
    db.session.delete(metric)
```

Хорошо:

```python
if not metric.functions:
    db.session.delete(metric)
```
